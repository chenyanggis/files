# files
存些随笔
## Vite
vite的来源或者核心认为是`现代浏览器`，所谓依赖预编译、esbuild、rollup都是衍生产物。
vite作者出发点是`提速`，而前端资源及js语言性能有限，自然把目光投到浏览器上。现代浏览器支持ESModule，那为什么不让浏览器来承担`构建`这部分工作？前端只负责把代码编译成浏览器可识别的文件即可，这样速度指定soso的。

但是让浏览器'承担构建'有额外工作。一是既然使用`module`模式你就得把非ESModule的CommonJS三方依赖也转换成ESMoudle的给浏览器；二是你得对给到浏览器的东西进行筛选和处理，一股脑给浏览器太多太杂只会更慢（如引个lodash如果不处理浏览器需要发100多个请求，需要处理成按需引用）。

基于此，你需要在前端准备一个性能更好编译器承担这部分额外的工作。js没有压榨空间，那就换个语言，就选了基于go的esbuild。

依赖预构建能力解决了上述两个额外工作同时也保障了性能。一是把三方依赖在第一次启动的时候打到/node_modules/.vite/deps下面（当然需要treeShaking这些）同时存一个mata.json保存映射，一是把CommonJS转成ESModule。

### 为什么esbuild
使用GO编写，多线程，天生优势。主要做代码降级处理（ts->js,jsx->js）
劣势：只能将代码编译至ES6，低版本浏览器无法适配。无法做ast相关操作？为什么不能做codeSplit？

### Rollup
- 以其强大的 Tree-shaking 功能而闻名，可以在很大程度上减小输出的文件大小。
- 拥有庞大的插件生态系统，可以通过插件来执行各种不同的功能，例如代码拆分、语法转换等。这使得 Rollup 在定制和扩展方面更加灵活。
- 配置相对更丰富，允许用户更精细地控制构建过程，适用于更复杂的项目需求。

## Rust
rust具有和npm神似的依赖管理机制，npm使用它来进行用户认证模块的重写，使用 Rust 来解决 CPU 性能（nodejs无法避免的）产生的 npm 软件包注册瓶颈。
当开始用 Rust 语言实现时，他们在依赖管理方面发现了鲜明的对比。“Rust 语言有着绝对令人惊叹的依赖管理，”一位工程师热情地说，他指出 Rust 的依赖管理策略从 npm 获得了灵感。Rust 语言安装时附带的 Cargo 命令行工具与 npm 命令行工具类似：Cargo 分开协调每一个项目中的各依赖版本，从而让搭建每个项目时所在环境不会影响最终的执行结果。Rust 语言的开发体验很友好，符合 npm 团队受到 JavaScript 影响的预期。


